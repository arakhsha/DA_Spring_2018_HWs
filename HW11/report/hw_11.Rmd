---
title: "Create Map"
subtitle: "Earthquake Analysis"
author: "امین رخشا ۹۵۱۰۹۳۱۵"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

<div align="center">
<img  src="images/eqs003-001-2.png"  align = 'center'>
</div>

> <p dir="RTL"> 
با استفاده از داده های زلزله ها در ایران و جهان به سوالات زیر پاسخ دهید.
</p>

***


```{r h2o, results="hide", echo=FALSE, message=FALSE, warning=FALSE}
library(h2o)
h2o.init()
```

<p dir="RTL">
کارهای اولیه
</p>


```{r pre, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../pre.R")}

```

<p dir="RTL">
۱. با استفاده از داده های
historical_web_data_26112015.rds 
و استفاده از نمودار پراکنش سه بعدی بسته plotly نمودار طول، عرض و عمق زلزله ها را رسم نمایید. علاوه بر آن بزرگی هر نقطه را برابر بزرگی زمین لرزه قرار دهید.
</p>


```{r 1, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q1.R")}

```


***

<p dir="RTL">
۲. پویانمایی سونامی های تاریخی را بر حسب شدت بر روی نقشه زمین رسم نمایید.(از داده زلزله های بزرگ استفاده نمایید.)
</p>

<p dir="RTL">
از پکیج gganimate استفاده میکنیم. نتیجه را در زیر میبینید:
</p>


```{r 2, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q2.R")}

```

<img src="q2.gif">

***

<p dir="RTL">
۳. نمودار چگالی دو بعدی زلزله های تاریخی ایران را رسم کنید.( از داده iran_earthquake.rds و لایه stat_density_2d استفاده نمایید).
</p>



```{r 3, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q3.R")}

```


***

<p dir="RTL">
۴. احتمال اینکه در ایران در پنج سال آینده زلزله به بزرگی هفت ریشتر رخ دهد را محاسبه کنید. (از احتمال شرطی استفاده کنید.)
</p>

<p dir="RTL">
ابتدا با اجتماع گرفتن تمام داده&zwnj;ها لیست تا حد ممکن کاملی از زلزله&zwnj;های ایران به دست می&zwnj;آوریم. تنها زلزله&zwnj;های ۱۰۰ سال اخیر که داده&zwnj;ی کاملی از آن در دسترس داریم را در نظر می&zwnj;گیریم. با استفاده از این لیست توزیع فاصله&zwnj;ی میان زلزله&zwnj;های بزرگ متوالی به دست می&zwnj;آوریم. سپس از روی این توزیع احتمال این که فاصله&zwnj;ی زلزله&zwnj;ی بعدی با آخرین زلزله کمتر از ۶ سال باشد به شرط این که حداقل یک سال باشد (آنچه تا کنون رخ داده است) را محاسبه می&zwnj;کنیم.
</p>


```{r 4, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q4.R")}

```



***

<p dir="RTL">
۵. بر اساس داده های زلزله های بزرگ ابتدا تعداد و متوسط کشته زلزله ها را بر حسب کشور استخراج نمایید. سپس نمودار گرمایی تعداد کشته ها را بر روی کره زمین رسم نمایید.(مانند مثال زیر!)
</p>

<p dir="RTL">
برای بهتر مشخص شدن تمام کشور&zwnj;ها، لگاریتم میانگین کشته&zwnj;ها را هم در یک نمودار دیگر رسم می&zwnj;کنیم:
</p>


<div align="center">
<img  src="images/jvector.png"  align = 'center'>
</div>

```{r 5, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q5.R")}

```


***

<p dir="RTL">
۶. با استفاده از داده لرزه های بزرگ و به وسیله طول، عرض، شدت، عمق مدلی برای پیش بینی تعداد کشته های زلزله بیابید.
</p>

<p dir="RTL">
یک مدل خطی تعمیم یافته برای پیشبینی کشته&zwnj;ها می&zwnj;سازیم. توزیع تعداد کشته&zwnj;ها را پواسون در نظر می&zwnj;گیریم و از این خانواده استفاده می&zwnj;کنیم. نتیجه را در زیر می&zwnj;بینید:
</p>


```{r 6, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q6.R")}

```


***

<p dir="RTL">
۷. با استفاده از داده worldwide.csv به چند سوال زیر پاسخ دهید. تحقیق کنید آیا می توان از پیش لرزه، زلزله اصلی را پیش بینی کرد؟
</p>

<p dir="RTL">
برای تشخیص پیش&zwnj;لرزه و پس&zwnj;لرزه&zwnj;های یک واقعه به این صورت عمل می&zwnj;کنیم: ابتدا با رند کردن طول و عرض جغرافیایی موقعیت مکانی&zwnj;را به ناحیه&zwnj;ها تبدیل می&zwnj;کنیم. سپس در هر ناحیه هر ۵ روز را یک بازه در نظر می&zwnj;گیریم. برای هر ناحیه و هربازه&zwnj;ی زمانی زلزله&zwnj;ها را مربوط به یک واقعه در نظر می&zwnj;گیریم. حال برای بررسی پیشبینی پذیری زلزله اصلی فاصله&zwnj;ی زمانی اولین لرزه و بزرگترین لرزه برای وقایع مختلف محاسبه می&zwnj;کنیم. اگر توزیع این فاصله به گونه&zwnj;ای باشد که بتوان با دقت خوبی زمان زلزله اصلی را فهمید یعنی به یک معنی می&zwnj;توان پیشبینی را انجام داد. نمودار توزیع در زیر کشیده شده است. می&zwnj;بینیم که چنین ویژگی&zwnj;ای ندارد و بعد از اولین لرزه، زلزله&zwnj;ی اصلی می&zwnj;توان در زمان&zwnj;های مختلفی بیاید و نمی&zwnj;توان زمان آن را پیشبینی و آن روز را تعطیل اعلام کرد. پس این کار ممکن نیست.
</p>
<p dir="RTL">
منابع دیگر اینترنتی هم این موضوع را تایید می&zwnj;کنند که پیشبینی زلزله کار دشواری است و به این آسانی&zwnj;ها نیست!
</p>

```{r 7, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q7.R")}

```


***

<p dir="RTL">
۸. گزاره " آیا شدت زلزله به عمق آن بستگی دارد" را تحقیق کنید؟ (طبیعتا از آزمون فرض باید استفاده کنید.)
</p>

<p dir="RTL">
از آزمون کوریلیشن با روش spearman استفاده می&zwnj;کنیم. می&zwnj;بینیم که طبق تست رابطه&zwnj;ی مستقیمی بین این دو کمیت وجود دارد!
</p>


```{r 8, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q8.R")}

```


***

<p dir="RTL"> 
۹. میانگین سالانه زلزله ها را بر حسب کشور به دست آورید. آیا میتوان دلیلی در تایید یا رد تئوری هارپ ارائه کرد.
</p>

<p dir="RTL">
این میانگین در avg.eq.year  محاسبه شده است. برای بررسی تئوری توطئه&zwnj;ی هارپ فرض می&zwnj;کنیم که با اعمال این پروژه به طور کلی شدت زلزله&zwnj;های یک کشور از سالی به بعد یا در یک سال خاص بیشتر از سال&zwnj;های دیگر می&zwnj;شود. برای بررسی این پدیده با تست kruskal شدت زلزله&zwnj;های سال&zwnj;های مختلف را برای هر کشور بررسی می&zwnj;کنیم تا ببینیم آیا شدت زلزه&zwnj;ها به سال مربوط است یا نه. لیست کشورهایی که در این تست پی ولیو کمی آورده&zwnj;&zwnj;اند را در زیر می&zwnj;بینید. می&zwnj;بینیم که حتی خود آمریکا هم در این لیست هست و بقیه&zwnj;ی کشورها هم دشمنی خاصی با آمریکا ندارند! پس به نظر می&zwnj;آید نباید این تئوری را جدی گرفت.
</p>


```{r 9, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q9.R")}

```


***

<p dir="RTL"> 
۱۰. سه حقیقت جالب در مورد زلزله بیابید.
</p>

<p dir="RTL">
به طور کلی زلزله&zwnj;ها بیشتر از سونامی&zwnj;ها قربانی می&zwnj;گیرند.
</p>

<p dir="RTL">
با تست Wilcoxon تعداد کشته&zwnj;های زلزله&zwnj;ها و سونامی&zwnj;های با شدت حداقل ۶ ریشتر را بررسی کردیم. طبق این تست قربانی&zwnj;های زلزله&zwnj;ها بیشتر از سونامی&zwnj;ها هستند.
</p>


```{r 10A, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q10A.R")}

```

<p dir="RTL">
علیرغم رشد جمعیت جهان و شهر&zwnj;ها تعداد کشته&zwnj;های زلزله&zwnj;ها در حدود صد سال اخیر کاهش بافته است.
</p>

<p dir="RTL">
برای بررسی این موضوع از تست کوریلیشن میان سال و تعداد کشته&zwnj;های زلزله&zwnj;ها استفاده می&zwnj;کنیم. می&zwnj;بینیم که رابطه&zwnj;ی عکسی میان این دو برقرار است. این درحالی است که با رشد جمعیت جهان و شهرها قاعدتا یاد تعداد کشته&zwnj;ها یبشتر شود ولی گویا رشد تکنولوژی ساخت و ساز و روش&zwnj;ها مقابله با فاجعه باعث شده است که تعداد کشته&zwnj;ها کاهش یابد.
</p>


```{r 10B, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q10B.R")}

```


<p dir="RTL">
با این که زلزله&zwnj;ها بیشتر قربانی می&zwnj;گیرند، تعدا خانه&zwnj;های تخریب شده&zwnj;ی سونامی&zwnj;ها و زلزله&zwnj;ها تفاوتی  معنی&zwnj;داری ندارد.
</p>

<p dir="RTL">
مانند گزاره&zwnj;ی اول عمل می&zwnj;کنیم ولی این بار نتیجه&zwnj;ی تست significant نمی&zwnj;شود.
</p>

```{r 10C, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q10C.R")}

```
