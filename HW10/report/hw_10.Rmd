---
title: "Cluster Analysis"
subtitle: "WDI Indicators"
author: "امین رخشا ۹۵۱۰۹۳۱۵"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

<div align="center">
<img  src="images/best_hans_talks_1200x627.jpg"  align = 'center'>
</div>

> <p dir="RTL"> 
با توجه به داده بانک جهانی به سوالات زیر پاسخ دهید. برای استفاده از داده از سه فایل زیر استفاده نمایید.
داده نام کشورها: WDICountry
داده نام سری های زمانی: WDISeries
داده کل: WDIData
در صورتی که داده را در اختیار ندارید می توانید از بسته WDI استفاده نموده و داده های مورد نظر را استخراج نمایید.
</p>

***

<p dir="RTL">
کارهای اولیه
</p>

```{r h2o, results="hide", echo=FALSE, message=FALSE, warning=FALSE}
library(h2o)
h2o.init()
```

```{r pre, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../pre.R")}

```

<p dir="RTL">
۱. ده کشور فقیر دنیا را بیابید. نمودار درآمد روزانه آنها را رسم کنید. چند درصد از اعضای این کشورها زیر خط فقر هستند؟ متوسط عمر در این کشورها چقدر است؟
</p>

<p dir="RTL">
از درآمد سرانه&zwnj;ی داخلی برای محاسبه&zwnj;ی فقیرترین کشورها استفاده می&zwnj;کنیم. با توجه به در دسترس نبودن شاخص&zwnj;های امید به زندگی و خط فقر در آخرین سال، برای هر کشور آخرین داده&zwnj;ای که از آن موجود است را استفاده می&zwnj;کنیم.
</p>


```{r 1, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q1.R")}

```


***

<p dir="RTL">
۲. تراژدی روآندا: بر اساس داده های امید به زندگی ابتدا نمودار سالانه نمودار جعبه ایی امید به زندگی کشورها را رسم نمایید(در یک نمودار!). سپس سری زمانی امید به زندگی روآندا را به آن اضافه کنید. چه می بینید؟ چند میلیون نفر کشته شدند؟
</p>

<p dir="RTL">
نمودار کل کشورها و این نمودار به همراه سری زمانی امید به زندگی در رواندا را در زیر می&zwnj;بینید. در این تراژدی ۵۰۰ هزار تا یک میلیون نفر کشته شدند.
</p>


```{r 2, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q2.R")}

```


***

<p dir="RTL">
۳. نمودار امید به زندگی و هزینه های بهداشتی را رسم کنید. چه نتیجه ایی می گیرید؟
</p>

<p dir="RTL">
همانطور که میبینیم در کشورهایی که هزینه&zwnj;ها بالاتر است امید به زندگی نیز بیشتر هست. اما این ارتباط خطی نیست و با بالا رفتن هزینه میزان افزایش امید به زندگی کاهش می&zwnj;یابد. در حقیقت همانطور که در نمودار میبینید تا حدی امید به زندگی با لگاریتم هزینه&zwnj;ها رابطه دارد.
</p>

```{r 3, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q3.R")}

```

***

<p dir="RTL">
۴. آیا قدرت خرید خانواده های ایرانی در ۵۰ سال اخیر افزایش یافته است؟ برای این کار از داده های اقتصادی خانوار استفاده کنید.
</p>

<p dir="RTL">
از شاخص Household final consumption expenditure per capita استفاده می&zwnj;کنیم. میبینیم که به جز چند سال اخیر قدرت خرید مردم اضافه شده است. با تست کوریلشن pearson هم این مسئله را بررسی می&zwnj;کنیم.
</p>

```{r 4, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q4.R")}

```


***

<p dir="RTL">
۵. رشد اقتصادی ایران را با کشورهای دیگر در طول ۲۰ سال گذشته بر حسب بیست شاخص های اقتصادی مهم مانند تولید ناخالص ملی، تورم و … ارزیابی کنید! (برای هر شاخص از تصویرسازی استفاده کنید.)
</p>

<p dir="RTL">
برای انتخاب شاخص&zwnj;ها، ابتدا آن&zwnj;هایی که در ۲۰ سال اخیر برای ایران موجود هستند را جدا می&zwnj;کنیم. سپس آن&zwnj;ها را براساس این که چقدر در داده موجود هستند مرتب می&zwnj;کنیم. سعی می&zwnj;کنیم شاخص&zwnj;های مهمی که بیشتر در داده موجود هستند را انتخاب کنیم. برای مقایسه هم ایران را در نمودار&zwnj;های جعبه&zwnj;ای سالانه&zwnj;ی این شاخص&zwnj;ها مشخص کردیم. برای خوانایی بیشتر داده&zwnj;های پرت از نمودارها رسم شده&zwnj;اند.
</p>

```{r 5, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q5.R"), fig.width=10, fig.height=10}

```

***

<p dir="RTL">
۶. در قسمت قبل با استفاده از روش خوشه بندی k-means داده ها را به سه دسته تقسیم کنید. ایران در کدام دسته می گنجد؟ (پیش از خوشه بندی طبیعتا داده را باید پاکسازی و استاندارد سازی نمایید.)
</p>

<p dir="RTL">
نتایج در زیر آمده&zwnj;اند. خوشه&zwnj;ی یک کشورهای جهان سومی و توسعه نیافته اند. خوشه&zwnj;ی ۲ تقریبا پیشرفته ترین کشورها با مهم&zwnj;ترین اقتصادها هستند و خوشه&zwnj;ی ۳ هم کشورهای پیشرفته&zwnj;ی دیگر هستند.
</p>

```{r 6, message=FALSE, warning=FALSE, fig.align='center', tidy=TRUE, tidy.opts=list(width.cutoff=60), code=readLines("../Q6.R")}

```

***

<p dir="RTL">
۷. به وسیله تحلیل مولفه اصلی بعد داده رو به دو کاهش دهید سپس خوشه های به دست آمده در قسمت قبل را بر روی آن نمایش دهید. آیا عملکرد روش خوشه بندی شما مطلوب بوده است؟
</p>

<p dir="RTL">
می&zwnj;بینیم که خوشه بندی تا حد خوبی درست عمل کرده است.
</p>

```{r 7, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q7.R")}

```

***

<p dir="RTL">
۸. با استفاده از داده روشی برای پیش بینی رشد اقتصادی ایران در سال آینده ارائه دهید.
</p>

<p dir="RTL">
با استفاده از شاخص&zwnj;های هر سال، سعی می&zwnj;کنیم با استفاده از یک مدل خطی رشد اقتصادی سال بعد را پیشبینی کنیم. ابتدا سعی می&zwnj;کنیم با همان ۲۰ شاخصی که برای خوشه بندی استفاده کردیم اما خیلی از شاخص&zwnj;ها significant نمی&zwnj;شوند. برای همین تعدادی از آن&zwnj;ها را حذف می&zwnj;کنیم و با اندکی تغییر به شاخص&zwnj;هایی که در جدول آمده&zwnj;اند می&zwnj;رسیم. می&zwnj;بینیم که نتیجه خیلی هم بد نیست.
</p>

```{r 8, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q8.R")}

```

***

<p dir="RTL"> 
۹. سوالهای ۵ تا ۷ را ابتدا برای ۲۰ شاخص سلامت سپس بر حسب ۲۰ شاخص آموزشی تکرار کنید.
</p>

<p dir="RTL">
مشابه سوالات قبل عمل می&zwnj;کنیم. نتایج را در زیر می&zwnj;بینید:
</p>

```{r 9edu_5, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q9_Education_5.R"), fig.width=10, fig.height=10}

```


```{r 9edu_6, message=FALSE, warning=FALSE, fig.align='center', tidy=TRUE, code=readLines("../Q9_Education_6.R")}

```


```{r 9edu_7, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q9_Education_7.R")}

```

```{r 9health_5, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q9_Health_5.R"), fig.width=10, fig.height=10}

```

```{r 9health_6, message=FALSE, warning=FALSE, fig.align='center', tidy=TRUE, code=readLines("../Q9_Health_6.R")}

```

```{r 9health_7, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q9_Health_7.R")}

```



***

<p dir="RTL"> 
۱۰. کشورهای دنیا را بر حسب ۶۰ شاخص اقتصادی، سلامت و آموزش با روش سلسله مراتبی خوشه بندی کرده و دندروگرام آن را رسم نمایید. اگر داده ها بر سه دسته تقسیم شوند ایران در کدام دسته می گنجد؟
</p>

<p dir="RTL">
نتایج را در زیر میبینید:
</p>


```{r 10, message=FALSE, warning=FALSE, fig.align='center', tidy=TRUE, fig.width=10, code=readLines("../Q10.R")}

```



***

<p dir="RTL"> 
۱۱. سه یافته جالب از داده ها استخراج کنید.
</p>


<p dir="RTL">
جوانی جمعیت باعث افزایش رشد اقتصادی نمی&zwnj;شود.
</p>
<p dir="RTL">
بسیار می&zwnj;شنویم که جمعیت کشور در حال پیر شدن است و این در رشد اقتصاد ما موثر خواهد بود و باید با افزایش جمعیت با آن مقابله کرد. برای همین تلاش کردیم بررسی کنیم آیا کشورهایی که جوان&zwnj;تر هستند (جمعیت با سن بین ۱۵ تا ۶۵ سال درصد بیشتری از کل هستند) آیا رشد اقتصادی بیشتری دارند یا نه. با استفاده از تست کوریلشن روش spearman این ادعا را بررسی کردیم. به نظر می&zwnj;رسد با این داده نمی&zwnj;توان مستقل بودن این دو کمیت را رد کرد.
</p>


```{r 11A, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q11A.R")}

```


<p dir="RTL">
کشورهایی که در کاهش انتشار گازهای گلخانه&zwnj;ایشان تلاش می&zwnj;کنند رشد اقتصادی کمتری دارند.
</p>
<p dir="RTL">
دو کمیت میزان تغییر انتشار گازهای گلخانه&zwnj;ای نسبت به سال ۱۹۹۰ و رشد اقتصادی را با تست کوریلیشن spearman مقایسه کردیم. به نظر می&zwnj;رسد رابطه&zwnj;ی مستقیمی بین این دو کمیت برقرار است.
</p>

```{r 11B, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q11B.R")}

```


<p dir="RTL">
کشورهای مهاجرپذیر از کشورهای مهاجر رشد اقتصادی کمتری دارند.
</p>
<p dir="RTL">
انتظار داریم کشورهایی که مردم آن&zwnj;ها به خارج مهاجرت می&zwnj;کنند در شرایط بدتری باشند و رشد اقتصادی مناسبی نداشته باشند. اما بر خلاف انتظار اینطور نیست!! کشورهایی که مردم آن&zwnj;ها مهاجرت می&zwnj;کنند رشد اقتصادی بیشتری دارند! برای بررسی این موضوع از شاخص net migration و رشد اقتصادی استفاده می&zwnj;کنیم. نتیجه آنقدر شگفت آور بود که فکر کردیم شاخص net migration را اشتباه برداشت کرده&zwnj;ایم. برای همین برای بررسی کشورهای سوریه، آلمان و آمریکا رو بررسی کردیم که وضعیت آن&zwnj;ها را می&zwnj;دانیم. می&zwnj;بینیم که اشتباهی رخ نداده و نتیجه واقعیت دارد.
</p>

```{r 11C, message=FALSE, warning=FALSE, fig.align='center', code=readLines("../Q11C.R")}

```

