---
title: "Fifth Week: Bootstrap and Resampling Methods"
subtitle: "Nonparametric Hypothesis tests"
author: "امین رخشا ۹۵۱۰۹۳۱۵"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

<div align="center">
<img  src="images/NonparametricStatistics_iStock.jpg"  align = 'center'>
</div>

> <p dir="RTL"> 
لطفا با سوالات زیر پاسخ دهید.
در همه سوالات سطح دقت را ۹۵ درصد در نظر بگیرید.
</p>

***
<p dir="RTL">
۱. شرکتی میخواهد تحقیق کند آیا درآمد نمایندگی های آن یکسان است. برای بررسی این موضوع هشت نمایندگی
به طور تصادفی انتخاب شده اند که به ترتیب میزان فروش آنها عبارت است از 
102, 300, 102, 100, 205, 105, 71 , 92.
با توجه به داده آیا عملکرد نمایندگی ها یکسان است؟
</p>
<p dir="RTL">
درصورتی که عملکرد نمایندگی ها یکسان باشد، احتمال این که یک عمل فروش خاص، در یک نمایندگی باشد باید بین نمایندگی ها یکسان و برابر یک هشتم باشد. میخواهیم بررسی کنیم که آیا توزیع احتمال به این شکل هست یا نه. از تست Chi-square goodness of fit استفاده می کنیم. می بینیم که مقدار p-value کمتر از ۰.۰۵ است پس فرض صفر که یکسان بودن عملکرد نمایندگی ها بود رد می شود.
</p>
```{r 1, message=FALSE, warning=FALSE}
data = c(102, 300, 102, 100, 205, 105, 71, 92)
p = rep(1/length(data), length(data))
chisq.test(data, p = p)
```
***

<p dir="RTL">
۲. آمار فروش شرکتی در دو نوع شعبه سنتی و مدرن در زیر آمده است:
</p>

Classical stores: 50, 50, 60, 70, 75, 80, 90, 85

Modern stores: 55, 75, 80, 90, 105, 65

<p dir="RTL">
آیا تفاوتی در عملکرد دو نوع شعبه وجود دارد؟
</p>
<p dir="RTL">
با توجه به این که نمی توان توزیع دسته ها را نرمال فرض کرد، به جایt test از تست بی پارامتر Wilcoxon rank sum test استفاده می کنیم. خوبی این تست در برابر permutation test این است که در برابر دادهی پرت مقاوم است. می بینیم که p-value آنقدر کم نیست (بیشتر از ۰.۰۵) که بتوان فرض صفر که برابری این دو گروه است را رد کرد.
</p>
```{r 2, message=FALSE, warning=FALSE}
classicalStores = c(50, 50, 60, 70, 75, 80, 90, 85)
modernStores = c(55, 75, 80, 90, 105, 65)

wilcox.test(classicalStores, modernStores, paired=FALSE)
```

***

<p dir="RTL">
۳. اطلاعات حسابداری ۱۵ شعبه که به صورت تصادفی انتخاب شده اند به شرح زیر است:
</p>

509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904

<p dir="RTL">
شرکت مذکور برای ارتقای فروش خود یک طرح تبلیغاتی جدید را اجرا میکند. پس از طرح جدید نتایج عملکرد شعبه ها  به صورت زیر 
اندازه گیری شده است
</p>

517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901

<p dir="RTL">
آیا تبلیغات جدید عملکرد فروش را بالا برده است؟
</p>
<p dir="RTL">
در این سوال دادهی ما paired است. مانند سوال قبل چون نمی توان توزیع دسته ها را نرمال فرض کرد، به جای paired t test از تست بی پارامتر Wilcoxon signed rank استفاده می کنیم. می بینیم که p-value آنقدر کم نیست (بیشتر از ۰.۰۵) که بتوان فرض صفر که بالا نرفتن فروش است را رد کرد و بالا رفتن فروش است را پذیرفت.
</p>
```{r 3, message=FALSE, warning=FALSE}
before = c(509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904)
after = c(517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901)

wilcox.test(after, before, alternative = 'greater', paired = TRUE)
```
***

<p dir="RTL">
۴. محصولی در سه رنگ سفید آبی و قرمز تولید شده است.
پنج شعبه ار فروشگاه سازنده محصول به صورت تصادفی انتخاب شده و اطلاعات فروش آنها در زیر آمده است.
</p>

| Store | White | Blue | Red |
| :----: | :----: | :----: | :----: |
| 1. |	510 |	925 |	730 |
| 2. | 720 | 735 | 745 |
| 3. |	930 |	753 |	875 |
| 4. |	754 |	685 |	610 |
| 5. |	105	|  |  |

<p dir="RTL">
با توجه به داده های بالا آیا رنگی خاص در میزان فروش محصولات تاثیر دارد؟
</p>
<p dir="RTL">
برای بررسی توزیع گروهها از تست Kruskal-Wallis استفاده می کنیم. می بینیم که مقدار p-value بسیار زیاد است (بیشتر از ۰.۰۵) پس نمی توان فرض صفر که تاثیر نداشتن رنگ در فروش است را رد کرد.
</p>
```{r 4, message=FALSE, warning=FALSE}
white = c(510, 720, 930, 754, 105)
blue = c(925, 735, 753, 685)
red = c(730, 745, 875, 610)

data = data.frame(
  color = c(rep('white', length(white)),
            rep('blue', length(blue)),
            rep('red', length(red))),
  sells = c(white, blue, red)
)

kruskal.test(sells ~ color,
             data = data)
```
***

<p dir="RTL">
۵. یک موسسه نظرسنجی نظرات مردم در مورد رضایت از یک محصول که در ماه های فروردین اردیبهشت خرداد و تیر که از طریق تلویزیون 
تبلیغ شده است را مورد ارزیابی قرار می دهد.این کار بدین صورت است از افرادی در ماه اول سوال پرسیده می شود و در ماه آینده نیز از همان فرد سوال می شود که آیا از محصول مذکور راضی هستی یا خیر.
با توجه به داده ایی که در پیوست تمرین آمده است آیا تبلیغات تاثیر مثبتی در افزایش رضایت مردم داشته است؟
</p>
<p dir="RTL">
برای بررسی تفاوت چند گروه با داده ی paired ، از تست Friedman استفاده می کنیم. باز هم مقدار p-value بسیار زیاد است  (بیشتر از ۰.۰۵) و نمی توان فرض صفر که یکسان بودن فروش در ماه های مختلف است را رد کرد.
</p>
```{r 5, message=FALSE, warning=FALSE}
library(readr)
tv = read_csv('tv.csv')
friedman.test(cbind(tv$March, tv$April, tv$May, tv$Jun))
```
***

<p dir="RTL"> 
۶. شرکتی در حال تحقیق بر روی این موضوع است که آیا جمعیت شهر تاثیری در نوع میزان مصرف محصولات شرکت دارد.
با توجه به داده زیر این موضوع را تحقیق کنید؟
</p>


| City size |	| Frequency of service usage | |
| :---: |  :---:  | :---: | :---: | 
| | Always	| Sometime | Never |
| Small	| 151	| 252	| 603 |
| Medium	| 802	| 603	| 405 |
| Large	| 753	| 55	| 408 |
<p dir="RTL">
برای بررسی برابری توزیع مربوط به سه گروه جمعیت از تست chi-square استفاده می کنیم. می بینیم که مقدار p-value کمتر از ۰.۰۵است پس فرض صفر که یکسان بودن توزیع برای سه گروه بود رد می شود و می توانیم بگوییم که جمعیت موثر است.
</p>
```{r 6, message=FALSE, warning=FALSE}
data = data.frame(small = c(151, 252, 603),
                  medium = c(802, 603, 405),
                  large = c(753, 55, 408))
chisq.test(data)
```
***

<p dir="RTL"> 
۷. شرکتی انتظار دارد با ارایه محصول الف میزان فروش محصول ب افزایش یابد.
به همین منظور به طور تصادفی از صد مشتری خود اطلاعات مصرف جمع آوری می نماید.
با توجه به داده های که داده شده آیا ربط معناداری بین فروش این دو محصول وجود دارد؟
</p>
<p dir="RTL">
از spearman correlation استفاده می کنیم. یعنی کوریلیشن را با این روش که به خطی بودن رابطه بستگی ندارد محاسبه می کنیم و فرض صفر ۰ بودن کوریلیشن را تست می کنیم. میبینیم که کوریلیشن با این روش مقدار کم ۰.۰۳۸ و p-value هم برای ناصفر بودن آن بسیار زیاد (بیشتر از ۰.۰۵) است. پس نمی توان نبود رابطه بین فروش دو محصول را رد کرد.
</p>
```{r 7, message=FALSE, warning=FALSE}
library(readr)
consumption = read_csv('consumption.csv')
cor.test(consumption$A,
         consumption$B,
         method = 'spearman')
```
***

<p dir="RTL"> 
۸. یک شرکت از ۲۰۰۰ نفر از مشتریان خود عامل خرید محصول را مورد سوال قرار میدهد 
که خلاصه اطلاعات آن را در زیر می توانید مشاهده کنید
</p>

| Characteristics	| Male	| Female |
| :---: |  :---:  | :---: |
| Price	| 301	| 502 |
| Design	| 353	| 155 |
| Color	| 558	| 153 |

<p dir="RTL"> 
آیا جنسیت تاثیری در مشخصه کاربری کالا دارد؟
</p>
<p dir="RTL">
مانند سوال ۶ از تست chi-square برای بررسی استقلال جنسیت و عامل فروش، یعنی یکسان بودن توزیع دو ستون male و female استفاده می کنیم. می بینیم که p-value کمتر از ۰.۰۵ است پس فرض صفر رد می شود و نتیجه می گیریم که جنسیت در عامل فروش موثر است.
</p>
```{r 8, message=FALSE, warning=FALSE}
data = data.frame(male = c(301, 353, 558), female = c(502, 155, 153))
chisq.test(data)
```


